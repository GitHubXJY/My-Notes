# 计算机网络

## 1 应用层

### 1.1 HTTP

HTTP（Hypertext Transfer Protocol）是一种应用层协议，用于在客户端和服务器之间传输超文本数据。下面详细介绍HTTP协议的特点、工作原理以及常见应用：

**特点**

1. 无状态性：HTTP是无状态协议，每个请求都是独立的，服务器不会保存客户端的状态信息。这意味着每次请求都是独立的，服务器不能区分多个请求是否来自同一个客户端。
2. 简单易用：HTTP协议使用简单、易于理解的文本格式进行通信，使得它容易被开发者和用户理解和使用。
3. 灵活性：HTTP协议支持各种不同类型的数据传输，如文本、图像、音频、视频等，可以满足各种不同类型的应用需求。
4. 无连接：HTTP是无连接的协议，每次请求和响应都是独立的，客户端和服务器之间不会保持持久的连接。
5. 基于请求-响应模型：HTTP采用请求-响应模型，客户端发送请求给服务器，服务器处理请求并返回响应给客户端。

**工作原理**

1. 建立连接：客户端发起一个HTTP请求时，首先需要与服务器建立TCP连接。
2. 发送请求：客户端向服务器发送一个HTTP请求，包含请求方法（GET、POST等）、资源路径、请求头等信息。
3. 服务器处理请求：服务器接收到请求后，根据请求的内容进行相应的处理，可能是获取资源、处理数据等操作。
4. 返回响应：服务器处理完请求后，向客户端发送一个HTTP响应，包含状态码、响应头和响应体等信息。
5. 关闭连接：服务器发送完响应后，TCP连接可能会保持一段时间（持久连接），或者立即关闭（非持久连接），取决于请求头中的Connection字段。

**常见应用**

1. 网页浏览：HTTP是Web浏览器与Web服务器之间通信的基础，用于请求和传输HTML页面、图片、CSS文件、JavaScript脚本等资源。
2. API调用：许多Web服务通过HTTP提供API，允许客户端应用程序与服务器进行通信，以获取数据或执行操作。
3. 文件下载：HTTP可以用于文件下载，客户端通过HTTP请求下载服务器上的文件。
4. Web服务：许多Web服务基于HTTP协议构建，通过HTTP提供各种功能和服务，如身份验证、数据存储、消息传递等。
5. RESTful服务：RESTful API是一种基于HTTP协议设计的API风格，使用HTTP方法（GET、POST、PUT、DELETE等）和资源路径来进行通信。

### 1.2 HTTP 和 HTTPS

**HTTP（Hypertext Transfer Protocol）**

1. 不安全传输：HTTP是一种明文传输协议，数据在传输过程中是未加密的，容易被窃听和篡改。
2. URL以**http://**开头,例如：http://www.example.com。
3. 端口号：HTTP默认使用端口号80进行通信。
4. 速度：由于不需要进行加密解密操作，HTTP通信速度较快。
5. 应用场景：适用于不涉及敏感信息传输的场景，如浏览网页、阅读新闻等。

**HTTPS（Hypertext Transfer Protocol Secure）**

1. 安全传输：HTTPS是在HTTP的基础上加入了SSL/TLS协议进行加密，数据在传输过程中是加密的，更加安全可靠。
2. URL以**https://**开头，例如：https://www.example.com。
3. 端口号：HTTPS默认使用端口号443进行通信。
4. 证书验证：HTTPS通过SSL/TLS证书对服务器进行身份验证，确保客户端与服务器之间的通信是安全可信的。
5. 速度：由于需要进行加密解密操作，HTTPS通信速度相对于HTTP会稍慢一些，但随着SSL/TLS的优化，速度差距已经不太明显。
6. 应用场景：适用于涉及敏感信息传输的场景，如在线支付、个人信息登录、电子邮件发送等。

### 1.3 打开网页的全过程和涉及到的协议

1. DNS解析

- 当用户在浏览器中输入网页的URL时，浏览器首先会进行DNS解析，将域名转换成对应的IP地址。
- DNS解析使用UDP协议进行通信，通过DNS服务器来查询域名对应的IP地址。

2. 建立TCP连接

- 一旦获得了目标服务器的IP地址，浏览器就会与服务器建立TCP连接。
- TCP连接使用三次握手建立连接，确保客户端和服务器之间的可靠通信。

3. 发送HTTP请求

- 客户端（浏览器）向服务器发送HTTP请求，请求包含了请求方法（GET、POST等）、资源路径、请求头等信息。
- HTTP请求使用TCP协议进行传输，数据以明文形式发送到服务器。

4. 服务器处理请求

- 服务器接收到HTTP请求后，根据请求的内容进行相应的处理,可能是获取资源、处理数据等操作。

5. 服务器返回HTTP响应

- 服务器处理完请求后，向客户端发送一个HTTP响应，响应包含了状态码、响应头和响应体等信息。
- HTTP响应使用TCP协议进行传输，数据以明文形式发送到客户端。

6. 浏览器解析渲染页面

- 客户端接收到HTTP响应后，浏览器开始解析HTML、CSS、JavaScript等资源，并根据解析结果渲染页面。
- 浏览器会根据HTML中的链接和资源引用发起额外的HTTP请求，获取页面中所需的图片、样式表、脚本等资源。

7. 关闭TCP连接

- 页面加载完成后，客户端和服务器之间的TCP连接可以选择立即关闭（非持久连接），或者保持一段时间（持久连接）以便后续的请求。
- TCP连接的关闭使用四次挥手进行，确保客户端和服务器都安全地关闭连接。

在这个过程中，涉及到的主要协议有：

- DNS：用于域名解析，将域名转换成IP地址。
- TCP：用于建立可靠的连接，以及传输HTTP请求和响应数据。
- HTTP：用于客户端和服务器之间的通信，请求获取网页内容。
- HTTPS：如果网页采用HTTPS协议，则使用SSL/TLS对数据进行加密和认证，提供更高的安全性。

## 2 网络层

### 2.1 TCP/IP协议簇

1. IP协议（Internet Protocol）：负责在网络上定位和传送数据包。IPv4和IPv6是最常见的IP协议版本。

2. TCP协议（Transmission Control Protocol）：提供可靠的、面向连接的数据传输服务，确保数据的可靠性和顺序性。

3. UDP协议（User Datagram Protocol）：提供无连接的数据传输服务，不保证数据的可靠性和顺序性，适用于一些实时性要求较高的应用。
4. ICMP协议（Internet Control Message Protocol）：用于在IP网络上发送控制和错误消息，例如网络不可达、主机不可达等。
5. ARP协议（Address Resolution Protocol）：用于将IP地址解析成MAC地址，以便进行数据包的传输。

6. RARP协议（Reverse Address Resolution Protocol）：与ARP相反，用于将MAC地址解析成IP地址。

7. DHCP协议（Dynamic Host Configuration Protocol）：用于动态分配IP地址、子网掩码、网关等网络配置信息。

8. DNS协议（Domain Name System）：用于将域名解析成IP地址，实现网络中主机名到IP地址的转换。

### 2.2 TCP 和 UDP

#### 2.2.1 TCP（传输控制协议）

- 面向连接：TCP是一种面向连接的协议，通信双方在传输数据之前需要先建立连接，然后进行数据传输，最后再释放连接。这种连接方式确保了数据的可靠性和顺序性。
- 可靠性：TCP提供可靠的数据传输服务。它通过序号、确认和重传机制来确保数据的完整性和正确性。如果数据包丢失或损坏，TCP会重新发送数据，直到接收方正确地接收到数据。
- 流量控制：TCP通过流量控制机制来控制数据的传输速率，确保发送方不会发送过多的数据导致接收方无法处理。这种机制可以防止网络拥塞，并且适应网络的变化。
- 拥塞控制：TCP还具有拥塞控制功能，可以根据网络的拥塞程度来调整传输速率，从而避免网络拥塞进一步加剧。
- 有序性：TCP保证了数据包的有序性，即发送的数据包会按照发送的顺序到达接收方，并且不会重复、错乱。
- 适用场景：TCP适用于需要可靠数据传输、顺序传输和流量控制的应用场景，如文件传输、电子邮件、网页浏览等。

#### 2.2.2 UDP（用户数据报协议）

- 无连接：UDP是一种无连接的协议，通信双方在传输数据时不需要建立连接，直接发送数据包。因此，UDP的开销比TCP小，适用于一些对传输效率要求较高的应用场景。
- 不可靠性：相比TCP，UDP不提供数据的可靠性保证。它不会对数据包进行重传或者错误校验，因此在网络传输过程中可能会出现丢包、重复、错乱等问题。
- 简单性：UDP协议相对简单，没有TCP的连接管理、流量控制和拥塞控制等复杂机制。这使得UDP的实现更加轻量级，适用于一些对延迟要求较高、对可靠性要求较低的应用。
- 广播和多播：UDP支持广播和多播，可以将数据同时发送给多个接收方，适用于实时视频、音频等多媒体传输场景。
- 适用场景：UDP适用于对实时性要求高、对数据可靠性要求较低的应用场景，如音视频传输、在线游戏、DNS查询等。

#### 2.2.3 TCP 和 UDP 的区别

1. 连接方式

- TCP是面向连接的协议，通信双方在传输数据之前需要先建立连接，然后进行数据传输，最后释放连接。
- UDP是无连接的协议，通信双方在传输数据时不需要建立连接，直接发送数据包。

2. 可靠性

- TCP提供可靠的数据传输服务，通过序号、确认和重传机制确保数据的完整性和正确性。
- UDP不提供可靠性保证，数据包可能会丢失、重复或者错乱，不进行重传或错误校验。

3. 流量控制

- TCP通过流量控制机制来控制数据的传输速率，确保发送方不会发送过多的数据导致接收方无法处理。
- UDP不具备流量控制功能，发送方可以以任意速率发送数据，可能导致网络拥塞。

4. 拥塞控制

- TCP具有拥塞控制功能，可以根据网络的拥塞程度来调整传输速率，避免网络拥塞进一步加剧。
- UDP没有拥塞控制机制，发送方不会根据网络拥塞情况调整传输速率。

5. 有序性

- TCP保证了数据包的有序性，即发送的数据包会按照发送的顺序到达接收方，并且不会重复、错乱。
- UDP不保证数据包的有序性，可能导致接收方接收到的数据包顺序与发送方发送的顺序不同。

6. 头部开销

- TCP的头部开销较大，包含了序号、确认号、窗口大小等信息，使得每个TCP数据包的大小较大。
- UDP的头部开销较小，只包含了源端口、目标端口等基本信息，使得每个UDP数据包的大小较小。

7. 应用场景

- TCP适用于对数据可靠性和顺序性要求高的应用场景，如文件传输、电子邮件、网页浏览等。
- UDP适用于对实时性要求高、对数据可靠性要求低的应用场景，如音视频传输、在线游戏、DNS查询等。

### 2.3
