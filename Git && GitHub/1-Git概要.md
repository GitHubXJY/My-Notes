### 1. Git 的区与库

#### 1.1 Git 在本地的结构

Git 在本地有三个区：

- **工作区**：个人开发时数据内容的存放位置。
- **缓存区**：数据内容打算提交，但未提交的临时存储位置，将来可以提交到本地库，也可以撤回。
- **本地库**：存储每一个历史版本。

#### 1.2 Git 和代码托管中心

代码托管中心的作用是帮助维护远程库。

局域网环境下

- 搭建 GitLab 服务器作为代码托管中心

互联网环境下

- 使用 GitHub 或者 Gitee 作为代码托管中心

#### 1.3 本地库和远程库的交互

1. 团队内部协作

项目发起者首先创建一个本地库，为了将代码上传到代码托管中心，在代码托管中心创建一个远程库。此时内容在本地库，远程库为空，使用`push`命令将本地库的内容推送到远程库。

项目开发人员借助`clone`命令，首先将远程库的内容 clone 到本地库，该命令同时会初始化创建本地库。
项目开发人员将开发内容`push`到远程仓库。(但开发者首先需要加入到开发团队)

项目开发人员将其开发内容`push`到远程仓库之后，项目发起者可以将内容`pull`到他的本地库。

2. 跨团队协作

外部开发人员首先需要`fork`该远程库，得到一个属于自己的远程库，然后将该远程库`clone`到本地库，完成修改之后`push`到属于外部开发人员的远程库。

然后外部开发人员发起`pull request`请求给项目发起者，审核之后项目发起者可以将内容`merge`到他的远程库。然后项目发起者和项目开发人员`pull`远程库到本地库，就有了外部开发人员的开发内容。

### 2. Git 基本原理

#### 2.1 哈希

哈希是一个系列的加密算法，各个不同的哈希算法虽然加密程度不同，但是有以下几个共同的：

1. 不管输入数据的数据量有多大，使用同一个哈希算法，得到的加密结果长度固定；
2. 哈希算法确定，输入数据确定，得到的结果确定不变；
3. 哈希算法确定，输入数据变化，得到的结果一定不同；
4. 哈希算法不可逆。

哈希算法常被用来验证文件，Git 底层采用 SHA-1 算法，原理如下：

原始文件哈希后得到一个哈希结果，文件经网络传输后，对传输后的文件使用同一个哈希算法进行哈希，将得到的哈希结果与原始文件的哈希结果进行比较，从而判断文件是否正确。

#### 2.2 Git 保存版本的机制

1. 集中式版本控制工具的文件管理机制

以文件变更列表的方式存储文件信息。这类系统将它们保存的文件信息看作：一组基本文件和每个文件随时间逐步累积的变化差异。

即新版本只保存与上一版本发生变化差异的那一部分。版本回退时，将基本文件与版本保存的变化差异拼接得到该版本的文件信息。

2. Git 的文件管理机制

Git 把数据看作是小型文件系统的一组快照，每次提交更新时 Git 会对当前的全部文件制作一个快照，并保存这个快照的索引。

如果文件没有修改，Git 不再重新存储该文件，而是只保留一个指向之前存储的文件的链接。

#### 2.3 Git 分支管理机制

创建一个新分支时，仅创建一个指向版本的指针，而不是复制一份所有文件。

当不同的分支都向前推进时，记录不同分支的内容。

切换分支，就是切换`HEAD`指针的指向。
